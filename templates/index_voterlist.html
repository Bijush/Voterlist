<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Voter Lists</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body { background: #f5f5f5; }

    .card-custom {
      border-radius: 14px;
      border: 1px solid #ddd;
      padding: 14px;
      background: white;
      transition: 0.2s;
    }
    .card-custom:hover {
      box-shadow: 0px 5px 15px rgba(0,0,0,0.12);
    }

    .loader {
      display: none;
      text-align: center;
      padding: 20px;
      font-weight: bold;
      color: #666;
    }
  </style>
</head>

<body class="p-3">

  <h3 class="text-center mb-3">ðŸ“‚ Voter List Records</h3>

  <!-- Filters -->
  <div class="row g-2 mb-3">
    <div class="col-6">
      <label class="form-label fw-bold">District</label>
      <select id="districtFilter" class="form-select">
        <option value="">All Districts</option>
        <option value="Cachar">Cachar</option>
        <option value="Karimganj">Karimganj</option>
        <option value="Hailakandi">Hailakandi</option>
      </select>
    </div>

    <div class="col-6">
      <label class="form-label fw-bold">LAC</label>
      <select id="lacFilter" class="form-select">
        <option value="">All LAC</option>
      </select>
    </div>

    <div class="col-12 mt-2">
      <label class="form-label fw-bold">Sort by Year</label>
      <select id="sortYear" class="form-select">
        <option value="asc">Ascending (Aâ€“Z)</option>
        <option value="desc">Descending (Newest First)</option>
      </select>
    </div>
  </div>

  <!-- Loading -->
  <div id="loading" class="loader">Loading...</div>

  <!-- Cards -->
  <div id="recordsContainer" class="mt-2"></div>

  <script>
    const lacData = {
      "Cachar": ["117 - Borkhola", "118 - Silchar", "119 - Udharbond"],
      "Karimganj": ["1 - North Karimganj", "2 - South Karimganj"],
      "Hailakandi": ["1 - Hailakandi LAC", "2 - Katlicherra LAC"]
    };

    const records = [
      { id: 1, district: "Cachar", lac: "117 - Borkhola", year: 2024, name: "Part 1", pdf: "#" },
      { id: 2, district: "Cachar", lac: "117 - Borkhola", year: 2023, name: "Part 2", pdf: "#" },
      { id: 3, district: "Karimganj", lac: "1 - North Karimganj", year: 2024, name: "List A", pdf: "#" }
    ];

    const districtFilter = document.getElementById("districtFilter");
    const lacFilter = document.getElementById("lacFilter");
    const sortYear = document.getElementById("sortYear");
    const container = document.getElementById("recordsContainer");
    const loader = document.getElementById("loading");

    // Auto Fill LAC
    districtFilter.addEventListener("change", () => {
      lacFilter.innerHTML = `<option value="">All LAC</option>`;
      const d = districtFilter.value;
      if (lacData[d]) {
        lacData[d].forEach(l => {
          lacFilter.innerHTML += `<option value="${l}">${l}</option>`;
        });
      }
      filterData();
    });

    lacFilter.addEventListener("change", filterData);
    sortYear.addEventListener("change", filterData);

    function filterData() {
      loader.style.display = "block";
      container.innerHTML = "";

      setTimeout(() => {
        let filtered = [...records];

        if (districtFilter.value)
          filtered = filtered.filter(r => r.district === districtFilter.value);

        if (lacFilter.value)
          filtered = filtered.filter(r => r.lac === lacFilter.value);

        filtered.sort((a, b) =>
          sortYear.value === "asc" ? a.year - b.year : b.year - a.year
        );

        loadCards(filtered);
        loader.style.display = "none";
      }, 300);
    }

    function loadCards(list) {
      if (list.length === 0) {
        container.innerHTML = `<p class="text-center text-muted mt-3">No voter list found</p>`;
        return;
      }

      list.forEach(rec => {
        const card = document.createElement("div");
        card.className = "card-custom mb-2";

        card.innerHTML = `
          <div class="d-flex justify-content-between">
            <div>
              <h5 class="mb-1">${rec.lac}</h5>
              <div class="text-muted small">${rec.district} â€¢ ${rec.year}</div>
            </div>

            <div class="d-flex align-items-center gap-3">
              <a href="${rec.pdf}" class="text-primary" title="View">
                <i class="bi bi-eye fs-5"></i>
              </a>

              <a href="${rec.pdf}" download class="text-success" title="Download">
                <i class="bi bi-download fs-5"></i>
              </a>

              <i class="bi bi-trash3 text-danger fs-5 delete-btn" data-id="${rec.id}" title="Delete" style="cursor:pointer"></i>
            </div>
          </div>
        `;

        container.appendChild(card);
      });

      activateDelete();
    }

    // Delete Function
    function activateDelete() {
      document.querySelectorAll(".delete-btn").forEach(btn => {
        btn.onclick = () => {
          const id = btn.getAttribute("data-id");

          if (confirm("Are you sure want to delete this record?")) {
            const index = records.findIndex(r => r.id == id);
            if (index > -1) {
              records.splice(index, 1);
              filterData();
            }
          }
        };
      });
    }

    filterData();
  </script>

</body>
</html>
